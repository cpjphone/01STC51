C51 COMPILER V9.01   SHIZHONG                                                              01/09/2015 20:37:20 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE SHIZHONG
OBJECT MODULE PLACED IN shizhong.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE shizhong.c BROWSE INCDIR(..\LCD1602_Drive) DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*************************************************************************************
   2          //LCD1602时钟测试程序
   3          *************************************************************************************/
   4          #include <reg52.h>                   //头文件
   5          #include <LCD1602_Drive.h>           //头文件
   6          
   7          uchar sec,min,hou=12;               //定义全局变量
   8          uchar tab[8]={0,0,10,0,0,10,0,0};    //时高位,时低位,：,分高位,分低位,：,秒高位,秒低位
   9          uchar code LCD1602_tab1[11]="0123456789:";   //字符串
  10          
  11          uchar code table[8]={0x00,0x0C,0x1E,0x1E,0x1E,0x1E,0x1E,0x1E};
  12          uchar code table1[8]={0x00,0x00,0x01,0x01,0x05,0x05,0x15,0x15};
  13          
  14          uchar count;  
  15          /*************************************************************************************
  16          延时函数                  
  17          *************************************************************************************/
  18          void delay(uint x)
  19          {
  20   1        uint i,j;
  21   1        for(i=0;i<x;i++)
  22   1          for(j=0;j<120;j++);
  23   1      }
  24          
  25          /*************************************************************************************
  26          初始化
  27          *************************************************************************************/
  28          void interrupt_init()
  29          {
  30   1        
  31   1        TMOD=0x01;              //定时器0，方式1
  32   1        TH0=(65536-50000)/256;
  33   1        TL0=(65536-50000)%256;
  34   1        EA=1;               //开总中断
  35   1        ET0=1;                //允许T0中断
  36   1        TR0=1;                //开定时器
  37   1      }
  38          /*************************************************************************************
  39          时分秒数据处理
  40          *************************************************************************************/
  41          void deal()
  42          {
  43   1        tab[6]=sec/10;
  44   1        tab[7]=sec%10;
  45   1        tab[3]=min/10;
  46   1        tab[4]=min%10;
  47   1        tab[0]=hou/10;
  48   1        tab[1]=hou%10;
  49   1      }
  50          
  51          /*************************************************************************************
  52          主函数
  53          *************************************************************************************/
  54          void main()
  55          {
C51 COMPILER V9.01   SHIZHONG                                                              01/09/2015 20:37:20 PAGE 2   

  56   1        uchar i;
  57   1        interrupt_init();
  58   1        LCD1602_init();
  59   1        while(1)
  60   1        {
  61   2          deal();
  62   2          LCD1602_write_com(0x80+0x04);           //设置指针地址为第一行第五个位置
  63   2          for(i=0;i<8;i++)
  64   2          {
  65   3            LCD1602_write_data(0x30+tab[i]);
  66   3          }
  67   2          LCD1602_write_com(0x80+0x43);           //设置指针地址为第二行第一个位置
  68   2          LCD1602_write_word("I am China");
  69   2        }
  70   1      }
  71          /*************************************************************************************
  72          定时器0中断服务程序，每50ms中断一次
  73          *************************************************************************************/
  74          void timer0() interrupt 1 using 1
  75          {
  76   1        TH0=(65536-50000)/256;
  77   1        TL0=(65536-50000)%256;
  78   1        count++;
  79   1        if(count>=20)
  80   1        {
  81   2          count=0;
  82   2          sec++;
  83   2          if(sec>59)
  84   2          {
  85   3            sec=0;
  86   3            min++;
  87   3            if(min>59)
  88   3            {
  89   4              min=0;
  90   4              hou++;
  91   4              if(hou>23)
  92   4              {
  93   5                hou=0;
  94   5              }
  95   4            }
  96   3          }
  97   2        }
  98   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    217    ----
   CONSTANT SIZE    =     38    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
