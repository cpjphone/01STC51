/*************************************1602“∫æßœ‘ æ≤ø∑÷*************************************/


#include <reg52.h>
#include <intrins.h>
#include "head.h"

sbit LCD_RS = P2^6;             
sbit LCD_RW = P2^5;
sbit LCD_EN = P2^7;


/*********************************************************************************/
void delayNOP()
{
         _nop_();
         _nop_();
         _nop_();
         _nop_();
}
/*********************************************************************************/


/*********************************************************************************/
/*								LCD“∫æß√¶¬µ≈–∂œ									 */
/*********************************************************************************/
bit lcd_busy()
{       
         bit result;
         LCD_RS = 0;
         LCD_RW = 1;
         LCD_EN = 1;
          delayNOP();
         result = (bit)(P0&0x80);
         LCD_EN = 0;
         return(result);
}
/*******************************************************************************/

/*********************************************************************************/
/*									LCD–¥√¸¡Ó									 */
/*********************************************************************************/
void lcd_wcmd(unsigned char cmd)
{       
         while(lcd_busy());
         LCD_RS = 0;
         LCD_RW = 0;
         LCD_EN = 0;
          _nop_();
          _nop_(); 
         P0 = cmd;
          delayNOP();
         LCD_EN = 1;
         delayNOP();
         LCD_EN = 0; 
}
/*****************************************************************************/

/*********************************************************************************/
/*									LCD–¥ ˝æ›									 */
/*********************************************************************************/
void lcd_wdata(unsigned char dat)
{                          
         while(lcd_busy());
          LCD_RS = 1;
         LCD_RW = 0;
         LCD_EN = 0;
         P0 = dat;
         delayNOP();
         LCD_EN = 1;
         delayNOP();
         LCD_EN = 0; 
}
/****************************************************************************/

/*********************************************************************************/
/*										LCD≥ı ºªØ								 */
/*********************************************************************************/
void lcd_init()
{ 
        delay_ms(15);                   
        lcd_wcmd(0x38);     
        delay_ms(5);
        lcd_wcmd(0x38);         
        delay_ms(5);
        lcd_wcmd(0x38);         
        delay_ms(5);
        lcd_wcmd(0x0c);     
        delay_ms(5);
        lcd_wcmd(0x06);      
        delay_ms(5);
        //lcd_wcmd(0x01);      
        //delay_ms(5);
}
/****************************************************************************/

/*********************************************************************************/
/*									LCDœ‘ æŒª÷√									 */
/*********************************************************************************/
void lcd_dis_pos(unsigned char pos)
{       
          lcd_wcmd(pos | 0x80); 
}
/****************************************************************************/